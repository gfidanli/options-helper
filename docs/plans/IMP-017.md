# IMP-017 — Engineering leverage: CI, pre-commit, type checks, perf/observability

- **Status:** done
- **Effort:** S–M
- **Alpha potential:** Medium

## Summary
This bundle doesn’t directly create trading “edge”, but it dramatically increases iteration speed and reduces regressions.
Add:
- CI (GitHub Actions) for ruff + pytest,
- optional type checking,
- pre-commit hooks,
- basic structured logging and per-command timing.

## Goals
- Any PR runs `ruff` and `pytest` in CI.
- Developers can run the same checks locally via `make test` or `...`.
- Commands invoked from cron write logs to `data/logs/` with timestamps.

## Non-goals
- Over-engineering a full observability stack.

## User-facing changes
- New developer tools:
  - `make lint`, `make test` (optional)
- Cron scripts emit logfiles under `data/logs/` (gitignored).

## Implementation plan
### Step 1 — Add GitHub Actions workflow
**Files:**
- `.github/workflows/ci.yml` (new)

**Work:**
- Set up Python matrix (3.10, 3.11, 3.12).
- Install with `pip install -e ".[dev]"`.
- Run `ruff check` and `pytest`.

### Step 2 — Pre-commit
**Files:**
- `.pre-commit-config.yaml` (new)

**Work:**
- Add ruff and basic whitespace hooks.

### Step 3 — Optional type checking
**Files:**
- `pyproject.toml` (add tool section)

**Work:**
- Start with “informational” type checks (don’t block CI initially) or block only on new files.

### Step 4 — Logging + timing
**Files:**
- `options_helper/cli.py`
- `scripts/*.sh`

**Work:**
- Add a `--log-dir` global option (default `data/logs`).
- Log start/end and per-symbol failures.

## Tests
- CI itself is the test.
- Add a small test to ensure logging setup doesn’t crash.

## Acceptance criteria
- A clean clone passes CI.
- Cron scripts produce logs that are easy to inspect after a run.
